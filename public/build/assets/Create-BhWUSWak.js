import{j as e,R as A,r as u,b as L,a as M}from"./app-KrnwSHJn.js";import{A as U}from"./AuthenticatedLayout-DiwffALl.js";import{S as h,C as P,o as f,A as J,G as K}from"./ActionBar-WMUz1Erl.js";import{C as Q,d as V}from"./Delete-DK_ZgqZR.js";import{B as l}from"./Box-C3rZ52Yg.js";import{T as m,I as X,S as B,A as Y}from"./Snackbar-DabAd_Z-.js";import{M as S}from"./MenuItem-E7RDDDLD.js";import{C as Z}from"./CustomSelectCategoryBox-CTmT3N-4.js";import"./ApplicationLogo-D2EIyXXd.js";import"./transition-BODHFSKf.js";import"./Autocomplete-BElCKSLM.js";function ee({index:n,handleFileChange:$,handleCheckboxChange:x,handleRemoveFileInput:C,selectedFile:o,type:v,handleTextChange:d}){let j=!0;try{j=o.src&&!1}catch{}return e.jsxs(Q,{className:"mb-4",sx:{width:"300px",height:"300px",margin:"20px",position:"relative",overflow:"hidden"},children:[e.jsx(l,{sx:{position:"absolute",bottom:"0px",left:"0px",width:"100%",backgroundColor:"lightblue",opacity:50},children:e.jsx("input",{type:"file",onChange:r=>$(n,r)})}),j&&e.jsx(l,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(m,{variant:"h5",component:"h2",color:"#444",children:"Select "+v})}),o&&e.jsxs("div",{className:"mt-2",children:[o.src&&e.jsx(l,{sx:{width:"100%",height:"100%"},children:e.jsx("img",{src:o.src,alt:`Selected file ${n}`,style:{width:"100%",height:"100%",objectFit:"cover"}})}),e.jsxs(h,{sx:{position:"absolute",top:"10px",left:"10px",margin:"7px",borderRadius:"12px",width:"200px",padding:"10px 20px ",backgroundColor:"#fff",color:"black"},spacing:1,children:[e.jsxs(l,{children:[e.jsx("input",{type:"checkbox",id:`isFrame-${n}`,checked:o.isFrame,onChange:r=>x(n,r,"frame")}),e.jsx("label",{htmlFor:`isFrame-${n}`,className:"ml-2",children:"Frame"})]}),e.jsxs(l,{children:[e.jsx("input",{type:"checkbox",id:`isText-${n}`,checked:o.isText,onChange:r=>x(n,r,"text")}),e.jsx("label",{htmlFor:`isText-${n}`,className:"ml-2",children:"Text"})]}),e.jsxs(l,{children:[e.jsx("input",{type:"checkbox",id:`isTop-${n}`,checked:o.isTop,onChange:r=>x(n,r,"isTop")}),e.jsx("label",{htmlFor:`isTop-${n}`,className:"ml-2",children:"Top"})]}),o.isFrame&&e.jsxs(P,{value:o.shapeType,label:"Shape Type",id:`shapeType-${n}`,labelId:`shapeType-${n}`,onChange:r=>x(n,r,"shapeType"),children:[e.jsx(S,{value:"circle",children:"Circle"}),e.jsx(S,{value:"square",children:"Square"}),e.jsx(S,{value:"other",children:"Other"})]})]})]}),e.jsx(l,{sx:{position:"absolute",top:"10px",right:"10px"},children:e.jsx(X,{onClick:()=>C(n),"aria-label":"delete",children:e.jsx(V,{color:"warning"})})}),o&&o.isText&&e.jsx(l,{sx:{position:"absolute",padding:"10px",bottom:"30px",left:"0px",width:"100%",backgroundColor:"white"},children:e.jsx(f,{sx:{width:"100%"},id:"outlined-basic",onChange:r=>{d(n,r)},label:"Enter text here",variant:"outlined"})})]},n)}function de({auth:n,type:$,title:x,headerOptions:C,categories:o,apiToken:v}){const[d,j]=A.useState({name:"",id:""}),[r,E]=u.useState(!1),N=(t,s)=>{s&&j({name:s.name,id:s.id})};A.useEffect(()=>{console.log("this is now selected: "+d.name)},[d]);const[c,w]=u.useState([]),[g,k]=u.useState([]),[p,R]=u.useState({title:"",tags:"",height:"",width:""}),[b,F]=u.useState({status:!1,message:"",severity:""}),I=(t,s)=>{s!=="clickaway"&&F(!1)},D=(t,s)=>{F({status:!0,message:t,severity:s})},y=(t,s)=>{R(a=>({...a,[t]:s}))},_=(t,s)=>{const a=s.target.files[0];if(a){const i=[...c];i[t]={id:a.name,src:URL.createObjectURL(a),x:0,y:0,rotation:0,image:a,isFrame:!1,isText:!1,isTop:!1,text:!1,shapeType:""},w(i)}},O=(t,s)=>{const a=[...c];a[t].text=s.target.value,w(a)},q=(t,s,a)=>{const i=[...c];i[t]&&(a==="frame"&&(i[t].isFrame=s.target.checked),a==="text"&&(i[t].isText=s.target.checked),a==="isTop"&&(i[t].isTop=s.target.checked),a==="shapeType"&&(i[t].shapeType=s.target.value),w(i))},W=t=>{const s=g.filter((i,T)=>T!==t),a=c.filter((i,T)=>T!==t);k(s),w(a)},z=()=>{k([...g,g.length])},G=u.useCallback(()=>{if(d.name&&r===!1){E(!0);const t=new FormData;let s=0;c.forEach((a,i)=>{a.isFrame&&s++,console.log(a.shapeType),t.append(`items[${i}][id]`,a.id),t.append(`items[${i}][src]`,a.src),t.append(`items[${i}][x]`,a.x),t.append(`items[${i}][y]`,a.y),t.append(`items[${i}][rotation]`,a.rotation),t.append(`items[${i}][image]`,a.image),t.append(`items[${i}][isFrame]`,a.isFrame?"1":"0"),t.append(`items[${i}][isText]`,a.isText?"1":"0"),t.append(`items[${i}][text]`,a.text),t.append(`items[${i}][isTop]`,a.isTop?"1":"0"),t.append(`items[${i}][shapeType]`,a.shapeType||0)}),t.append("user_id",n.user.id),t.append("title",p.title),t.append("tags",p.tags),t.append("height",p.height),t.append("width",p.width),t.append("source","panel"),t.append("frameCount",s),t.append("category_id",d.id),L.post(route("save.template"),t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${v}`}}).then(a=>{window.location.href=route("view.all.templates")}).catch(a=>{})}else D("Select a category first","warning")},[c]),H={Create:function(){G()},"Add Image":function(){z()}};return e.jsxs(U,{user:n.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Create Template"}),actionBar:e.jsx(J,{isCreateButtonDisabled:r,actions:H,headerOptions:C,children:e.jsx(Z,{categories:o,changeCategory:N})}),children:[e.jsx(M,{title:"Dashboard"}),b.status&&e.jsx(B,{open:b.status,autoHideDuration:4e3,onClose:I,TransitionComponent:K,anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(Y,{onClose:I,severity:b.severity,variant:"filled",sx:{width:"100%"},children:b.message})}),e.jsx(B,{}),e.jsx("div",{className:"square-pattern-bg",children:e.jsx("div",{className:"py-12",style:{width:"100%"},children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",style:{position:"relative",width:"100%"},children:[e.jsxs(h,{spacing:5,direction:"row",justifyContent:"center",sx:{padding:"30px 0px",backgroundColor:"white",width:"100%"},children:[e.jsxs(h,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter title for template"}),e.jsx(f,{onChange:t=>{y("title",t.target.value)},value:p.title,sx:{width:"200px"},id:"outlined-basic",label:"Title",variant:"outlined"})]}),e.jsxs(h,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter tags for template"}),e.jsx(f,{onChange:t=>{y("tags",t.target.value)},value:p.tags,sx:{width:"200px"},id:"outlined-basic",label:"Tags",variant:"outlined"})]}),e.jsxs(h,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter width for template"}),e.jsx(f,{onChange:t=>{y("width",t.target.value)},value:p.width,sx:{width:"200px"},id:"outlined-basic",label:"Width",variant:"outlined"})]}),e.jsxs(h,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter height for template"}),e.jsx(f,{onChange:t=>{y("height",t.target.value)},value:p.height,sx:{width:"200px"},id:"outlined-basic",label:"Height",variant:"outlined"})]})]}),g.length==0&&e.jsx(l,{sx:{width:"100%",height:"30vh",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(m,{variant:"h5",component:"h2",color:"#444",children:'Click "Add Image" button to add files'})}),e.jsx(h,{direction:"row",flexWrap:"wrap",justifyContent:"center",children:g.map((t,s)=>e.jsx(ee,{index:s,handleFileChange:_,handleRemoveFileInput:W,handleCheckboxChange:q,handleTextChange:O,selectedFile:c[s],type:s>1?"image":s==0?"thumbnail":"shade"},s))})]})})})]})}export{de as default};
